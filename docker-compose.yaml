services:

   mysqldb:
      image: mysql:latest
      volumes:
         - ./mysql/mysql-dump:/docker-entrypoint-initdb.d
      ports:
         - "3306:3306"
      # environment:
      #   - MYSQL_ROOT_PASSWORD=
      #   - MYSQL_USER=
      #   - MYSQL_PASSWORD=
      env_file:
         - secrets/mysql.env
      command: --default-authentication-plugin=mysql_native_password
      restart: always

   server:
      build: ./server
      volumes:
         - ./server/src:/app
         - /app/node_modules
      # environment:
      #    - DB_USER=
      #    - DB_PASSWORD=
      ports:
         - "81:80"
      env_file:
         - secrets/server.env
      depends_on:
         - mysqldb

   angular:
      build: ./angular
      volumes: 
         - ./angular/src:/app
         - /app/node_modules
      ports:
         - "4200:4200"
      depends_on:
         - server

   npm:
      build: 
         context: ./dockerfiles
         dockerfile: npm.dockerfile
      volumes:
         - ./src:/var/www/html

   ng:
      build: 
         context: ./dockerfiles
         dockerfile: ng.dockerfile
      volumes:
         - ./src:/var/www/html
      
